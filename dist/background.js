async function checkTranslationAPI(){try{const a=await chrome.i18n.getAcceptLanguages();return console.log("Available languages:",a),!0}catch(a){return console.error("API test failed:",a),!1}}async function checkAICapabilities(){try{const a=await ai.summarizer.capabilities(),e=await ai.languageModel.capabilities();return{canSummarize:"no"!==a.available,canPrompt:"no"!==e.available}}catch(a){return console.error("AI Capabilities check failed:",a),{canSummarize:!1,canPrompt:!1}}}let summarizer=null,languageSession=null;async function initializeAIServices(){const a=await checkAICapabilities();a.canSummarize&&(summarizer=await ai.summarizer.create()),a.canPrompt&&(languageSession=await ai.languageModel.create({systemPrompt:"You are a helpful assistant that answers questions about text content clearly and concisely."}))}chrome.runtime.onInstalled.addListener((()=>{initializeAIServices()})),chrome.runtime.onMessage.addListener(((a,e,t)=>{if("translate"===a.type){const{text:e,targetLang:n}=a.data,r=new URL("https://translate.googleapis.com/translate_a/single");return r.searchParams.append("client","gtx"),r.searchParams.append("sl","auto"),r.searchParams.append("tl",n),r.searchParams.append("dt","t"),r.searchParams.append("q",e),fetch(r).then((a=>a.json())).then((a=>{if(!a||!a[0])throw new Error("Invalid response from translation service");const e=a[0].map((a=>a[0])).join("");console.log("Translation successful:",e),t({translation:e})})).catch((a=>{console.error("Translation error:",a),t({error:a.message})})),!0}return"checkCapabilities"===a.type?(checkAICapabilities().then((a=>{t(a)})).catch((a=>{t({canSummarize:!1,canPrompt:!1})})),!0):"summarize"===a.type?(handleSummarization(a.data.text).then((a=>{t({summary:a})})).catch((a=>{t({error:a.message})})),!0):"prompt"!==a.type||(handlePrompt(a.data.text,a.data.question).then((a=>{t({answer:a})})).catch((a=>{t({error:a.message})})),!0)})),chrome.runtime.onInstalled.addListener((()=>{console.log("Extension installed"),checkTranslationAPI()}));